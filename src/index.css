@import "leaflet/dist/leaflet.css";

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        /* Premium Light Mode Tokens */
        --bg-primary: #ffffff;
        --bg-secondary: #f5f7fa;
        --text-primary: #0f172a;
        --text-secondary: #475569;
        --accent: #2563eb;

        /* shadcn defaults mapping */
        --background: var(--bg-primary);
        --foreground: var(--text-primary);
        --card: var(--bg-primary);
        --card-foreground: var(--text-primary);
        --popover: var(--bg-primary);
        --popover-foreground: var(--text-primary);
        --primary: 221.2 83.2% 53.3%;
        --primary-foreground: 210 40% 98%;
        --secondary: 210 40% 96.1%;
        --secondary-foreground: 222.2 47.4% 11.2%;
        --muted: 210 40% 96.1%;
        --muted-foreground: 215.4 16.3% 46.9%;
        --destructive: 0 84.2% 60.2%;
        --destructive-foreground: 210 40% 98%;
        --border: #e2e8f0;
        --input: #e2e8f0;
        --ring: 221.2 83.2% 53.3%;
        --radius: 1rem;
    }

    .dark {
        /* Premium Dark Mode Tokens */
        --bg-primary: #0b1020;
        --bg-secondary: #111827;
        --text-primary: #e5e7eb;
        --text-secondary: #9ca3af;
        --accent: #38bdf8;

        --background: var(--bg-primary);
        --foreground: var(--text-primary);
        --card: var(--bg-secondary);
        --card-foreground: var(--text-primary);
        --muted: var(--bg-secondary);
        --muted-foreground: var(--text-secondary);
        --border: #1e293b;
        --primary: 199 89% 60%;
    }
}

@layer base {
    * {
        @apply border-border;
    }

    body {
        @apply bg-background text-foreground transition-colors duration-200 antialiased font-sans;
        background-color: var(--background);
    }
}

/* Leaflet Popup Overrides for Glassmorphism */
.leaflet-popup-content-wrapper,
.leaflet-popup-tip {
    background: transparent !important;
    box-shadow: none !important;
    border: none !important;
}

/* Hide Popup on Mobile (Use Bottom Sheet instead) */
@media (max-width: 768px) {
    .leaflet-popup {
        display: none !important;
    }
}

.leaflet-popup-content {
    margin: 0 !important;
    padding: 0 !important;
    width: auto !important;
}

.leaflet-container a.leaflet-popup-close-button {
    color: white !important;
    top: 10px !important;
    right: 10px !important;
    padding: 8px !important;
    background: rgba(0, 0, 0, 0.5) !important;
    backdrop-filter: blur(4px);
    border-radius: 50%;
    width: 24px !important;
    height: 24px !important;
    display: flex;
    align-items: center;
    justify-content: center;
    font: 16px/14px Tahoma, Verdana, sans-serif !important;
    border: 1px solid rgba(255, 255, 255, 0.2);
    z-index: 100;
}

.leaflet-container a.leaflet-popup-close-button:hover {
    color: #38bdf8 !important;
    /* accent color */
    background: rgba(0, 0, 0, 0.7) !important;
}

/* Safe Area Utilities */
@layer utilities {
    .pt-safe {
        padding-top: env(safe-area-inset-top, 0px);
    }

    .pb-safe {
        padding-bottom: env(safe-area-inset-bottom, 0px);
    }

    .mb-safe {
        margin-bottom: env(safe-area-inset-bottom, 0px);
    }

    .mt-safe {
        margin-top: env(safe-area-inset-top, 0px);
    }

    .bottom-safe {
        bottom: env(safe-area-inset-bottom, 0px);
    }

    .top-safe {
        top: env(safe-area-inset-top, 0px);
    }
}

/* Native-like Drawer Animations */
@keyframes sheet-up {
    0% {
        transform: translateY(100%);
    }

    100% {
        transform: translateY(0);
    }
}

@keyframes fade-in {
    0% {
        opacity: 0;
    }

    100% {
        opacity: 1;
    }
}

.animate-sheet-up {
    animation: sheet-up 0.4s cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

.animate-fade-in {
    animation: fade-in 0.3s ease-out forwards;
}

/* Responsive Font Scaling */
@media (max-width: 380px) {
    .text-4xl {
        font-size: 1.875rem;
    }

    /* Shrink EV.KH on tiny screens */
    .p-6 {
        padding: 1rem;
    }
}